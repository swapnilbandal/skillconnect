package com.skillconnect.controller;

import com.skillconnect.model.FreelancerProfile;
import com.skillconnect.model.Project;
import com.skillconnect.service.MatchingServiceImpl;
import com.skillconnect.service.ProjectService;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.AotInitializerNotFoundException;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/match")
public class MatchingController {

    @Autowired
    private MatchingServiceImpl matchingService;

    @GetMapping("/freelancers/{projectId}")
    public List<FreelancerProfile> getMatchingFreelancers(@PathVariable int projectId) {
        Project project;
		try {
			project = ProjectService.getProjectById(projectId).orElseThrow(() -> new AotInitializerNotFoundException(null, "Project not found"));
		} catch (X e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
        return matchingService.matchFreelancersToProject(project);
    }

    @GetMapping("/projects/{freelancerId}")
    public List<Project> getMatchingProjects(@PathVariable int freelancerId) {
        FreelancerProfile freelancer = freelancerService.getFreelancerById(freelancerId).orElseThrow(() -> new ResourceNotFoundException("Freelancer not found"));
        return matchingService.matchProjectsToFreelancer(freelancer);
    }
}
